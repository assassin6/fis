<<<<<<< HEAD
<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<title>铭飞MS平台－我要分享</title>
    {ms:include filename=header.htm/}
    {ms:include filename=people/header.htm/}
</head>
<style>
	#upgraderVersion .plug{
		display: none;
	}
</style>
<body>
	{ms:include filename=head.htm/}

	<div class="user_center">
		<!--公用左边菜单部分开始-->
		{ms:include filename=people/menu.htm/}
		<!--公用左边菜单部分结束-->

		<div class="user_centent">
			<!--个人中心内容部分头部固定数据-->
			{ms:include filename=people/data.htm/}

			<!--更新提示-->
			<div class="user_cententbody" style="min-height:680px;">

				<!--我要发布-->
				<div class="user_cententbodynav">
					我要分享
					<p class="tip">提示：模板插件需提交审核才能正式发布，请耐心等待。</p>
				</div>
				<div class="releaseBody">
					<!--<ul class="shareStep" style="background-position: -640px;">
						<li class="onstep">1</li>
						<li>2</li>
						<li>3</li>
						<li>4</li>
						<li>5</li>
						<li style="margin: 0px;">6</li>
					</ul>-->
					<img src="{ms:globalskin.url/}/images/stepicon.jpg">
					<ul class="shareSteptxt">
						<li class="onstep">提交申请</li>
						<li>审核申请</li>
						<li>下载SDK</li>
						<li>上传文件</li>
						<li>审核文件</li>
						<li style="margin: 0px;">发布成功</li>
					</ul>
					

					<div class="releaseIn">
						<span class="active skin-title">模板</span> <span class="plug-title">插件</span>
					</div>
					<form class="form-horizontal" id="upgraderVersion">
						<input type="hidden" name="upgraderVersionType" id="upgraderVersionType" value="2">
                        <input type="hidden" name="mail_code" value="share" />
                        <input type="hidden" name="projectUpgraderVersionId" />
                        <input type="hidden" name="projectDatetime" value="2016/08/30" />
                        <input type="hidden" name="projectPeopleId" />
						<div class="form-group">
							<label class="col-sm-2 control-label">标题</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" maxlength="20"
									name="upgraderVersionName" placeholder="输入标题" required data-bv-notempty-message="标题不能为空">
							</div>
						</div>
						<!--div class="form-group">
							<label for=upgraderVersionChildType
								class="col-sm-2 control-label">类型</label>
							<div class="col-sm-2">
								<select class="form-control" name="upgraderVersionChildType">
									<option value="1">企业</option>
									<option value="2">商城</option>
									<option value="3">论坛</option>
								</select>
							</div>
						</div-->
						<div class="form-group skin">
							<label for="upgraderVersionOriginal"
								class="col-sm-2 control-label">是否原创</label>
							<div class="col-sm-2">
								<label class="radio-inline"> <input type="radio"
									name="upgraderVersionOriginal" value="0" checked="checked">
									是
								</label> 
								<label class="radio-inline"> <input type="radio"
									name="upgraderVersionOriginal" value="1" class="is_VersionOriginal"> 否
								</label>
							</div>
							<div class="col-sm-4 fill_url">
								<input type="url" class="form-control" name="upgraderVersionOriginalRefer" placeholder="参考网址 http://" data-bv-uri-message="地址无效"  required data-bv-notempty-message="仿站地址不能为空"/>
							</div>
						</div>
						<div class="form-group">
							<label for="upgraderVersionPrice" class="col-sm-2 control-label">赞助费</label>
							<div class="col-sm-2">
								<label class="radio-inline"> 
									<input type="radio" name="free" value="0" checked="checked"> 免费
								</label> 
								<label class="radio-inline"> 
									<input type="radio" name="free" value="1" class="is_VersionPrice"> 收费
								</label>
							</div>
							<div class="col-sm-3 fill_VersionPrice">
								<input type="text" class="form-control" maxlength="4"
									name="upgraderVersionPrice" placeholder="整数价格" 
									required data-bv-notempty-message="赞助金额不能为空"/>
							</div>
						</div>

						<!--项目信息-->
						<div class="form-group plug">
							<label class="col-sm-2 control-label">项目名称</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" 
									name="projectName" placeholder="输入项目名称" required
									data-bv-notempty-message="项目名称不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">包名</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" 
									name="projectPackage" placeholder="输入包名" required
									data-bv-notempty-message="包名不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">作者</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" maxlength="20"
									name="projectAuthor" placeholder="输入作者" required
									data-bv-notempty-message="作者不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">版本</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" maxlength="3"
									name="projectVersion" placeholder="输入版本" required
									data-bv-notempty-message="版本不能为空">
							</div>
						</div>

						<div class="form-group">
							<label for="upgraderVersionDescription"
								class="col-sm-2 control-label">描述</label>
							<div class="col-sm-9">
								<textarea class="form-control" rows="3" maxlength="200"
									name="upgraderVersionDescription" required
									data-bv-notempty-message="模版描述不能空" data-bv-stringlength="true"
									data-bv-stringlength-max="200" data-bv-stringlength-min="15"
									data-bv-stringlength-message="描述最多200个字符，最少15个字符"></textarea>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-2 col-sm-10">
								<button type="button" class="btn btn-primary submit_share_skin" style="width: 80px">提交</button>
							</div>
						</div>
					</form>


				</div>

			</div>
		</div>
	</div>


	{ms:include filename=footer.htm/}
</html>
<script>
	$(function() {
		/*前端验证赞助金额有效值*/
		$('#upgraderVersion').bootstrapValidator({
			feedbackIcons : {
				valid : 'glyphicon glyphicon-ok',
				invalid : 'glyphicon glyphicon-remove',
				validating : 'glyphicon glyphicon-refresh',
			},
	        fields: {
	            upgraderVersionPrice: {
	                validators: {
	                    between: {
	                        min:100,
	                        max:9000,
	                        message: '赞助金额在100-9000元内'
	                    }
	                }
	            }
			}
		});
		if("{upgraderVersionType/}" != null){
			if("{upgraderVersionType/}" == 1){
				$("#upgraderVersion .skin").hide();
				$("#upgraderVersion .plug").show();
				$("#upgraderVersionType").val("1");
				$(".skin-title").removeClass("active");
				$(".plug-title").addClass("active");
			}else{
				$("#upgraderVersion .skin").show();
				$("#upgraderVersion .plug").hide();
				$("#upgraderVersionType").val("2");
				$(".skin-title").addClass("active");
				$(".plug-title").removeClass("active");

			}
		}
		/*切换分享插件模板*/
		$(".releaseIn span").click(function(){
			$(".releaseIn span").removeClass("active");
			$(this).addClass("active");
			if($(this).hasClass("plug-title")){
				$("#upgraderVersion .skin").hide();
				$("#upgraderVersion .plug").show();
				$("#upgraderVersionType").val("1");
			}else{
				$("#upgraderVersion .skin").show();
				$("#upgraderVersion .plug").hide();
				$("#upgraderVersionType").val("2");
			}
		})
		/*选中是否收费和是否原创的效果*/
		$('.radio-inline').click(function() {
			/*选择收费则显示输入框输入金额*/
		    if($('.is_VersionPrice').is(':checked')) {
		    	$(".fill_VersionPrice").fadeIn();
			}else{
				$(".fill_VersionPrice").fadeOut();
				$(".fill_VersionPrice").bootstrapValidator("resetForm",true); 
			}
			/*选择非原创则显示输入框输入仿站地址*/
			if($(".is_VersionOriginal").is(':checked')) {
		    	$(".fill_url").fadeIn();
			}else{
				$(".fill_url").fadeOut();
				$(".fill_url").bootstrapValidator("resetForm",true); 
			}
		});
	})

	ms.load([ "ms", "ms.upgrader","ms.mcode"], function(ms, upgrader,mcode) {
		$(function() {
			/*提交模板分享*/
			$(".submit_share_skin").click(function() {
				var valid = $("#upgraderVersion").data('bootstrapValidator').validate().isValid();
				if (valid) {
                    $(".submit_share_skin").attr("disabled", true).text("提交中...");
					upgrader.people.save($("#upgraderVersion").serialize(), function(json) {
						if(json.result != null){
							ms.alert("分享申请提交失败，请稍后重新提交");
							$(".submit_share_skin").attr("disabled", false).text("提交");
							return;
						}else{
	                    	$("input[name=projectUpgraderVersionId]").val(json.upgraderVersionId)
							
							/*如果是提交插件分享，那再提交项目信息*/
							if($("input[name=upgraderVersionType]").val() == 1){
								mcode.people.mcode.project.save($("#upgraderVersion").serialize(), function(json) {
									if(json.result != null){
										$(".submit_share_skin").attr("disabled", false).text("提交");
										ms.alert("项目信息保存失败，请稍后重试！");
										return;
									}
								})
							}

							$(".submit_share_skin").attr("disabled", false).text("提交");
							ms.alert("分享申请成功");
							
							location.href=ms.base+"/people/center.do";
						}
					});
				}

			});


		})
	});
=======
<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<title>铭飞MS平台－我要分享</title>
    {ms:include filename=header.htm/}
    {ms:include filename=people/header.htm/}
</head>
<style>
	#upgraderVersion .plug{
		display: none;
	}
</style>
<body>
	{ms:include filename=head.htm/}

	<div class="user_center">
		<!--公用左边菜单部分开始-->
		{ms:include filename=people/menu.htm/}
		<!--公用左边菜单部分结束-->

		<div class="user_centent">
			<!--个人中心内容部分头部固定数据-->
			{ms:include filename=people/data.htm/}

			<!--更新提示-->
			<div class="user_cententbody" style="min-height:680px;">

				<!--我要发布-->
				<div class="user_cententbodynav">
					我要分享
					<p class="tip">提示：模板插件需提交审核才能正式发布，请耐心等待。</p>
				</div>
				<div class="releaseBody">
					<!--<ul class="shareStep" style="background-position: -640px;">
						<li class="onstep">1</li>
						<li>2</li>
						<li>3</li>
						<li>4</li>
						<li>5</li>
						<li style="margin: 0px;">6</li>
					</ul>-->
					<img src="{ms:globalskin.url/}/images/stepicon.jpg">
					<ul class="shareSteptxt">
						<li class="onstep">提交申请</li>
						<li>审核申请</li>
						<li>下载SDK</li>
						<li>上传文件</li>
						<li>审核文件</li>
						<li style="margin: 0px;">发布成功</li>
					</ul>
					

					<div class="releaseIn">
						<span class="active skin-title">模板</span> <span class="plug-title">插件</span>
					</div>
					<form class="form-horizontal" id="upgraderVersion">
						<input type="hidden" name="upgraderVersionType" id="upgraderVersionType" value="2">
                        <input type="hidden" name="mail_code" value="share" />
                        <input type="hidden" name="projectUpgraderVersionId" />
                        <input type="hidden" name="projectDatetime" value="2016/08/30" />
                        <input type="hidden" name="projectPeopleId" />
						<div class="form-group">
							<label class="col-sm-2 control-label">标题</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" maxlength="20"
									name="upgraderVersionName" placeholder="输入标题" required data-bv-notempty-message="标题不能为空">
							</div>
						</div>
						<!--div class="form-group">
							<label for=upgraderVersionChildType
								class="col-sm-2 control-label">类型</label>
							<div class="col-sm-2">
								<select class="form-control" name="upgraderVersionChildType">
									<option value="1">企业</option>
									<option value="2">商城</option>
									<option value="3">论坛</option>
								</select>
							</div>
						</div-->
						<div class="form-group skin">
							<label for="upgraderVersionOriginal"
								class="col-sm-2 control-label">是否原创</label>
							<div class="col-sm-2">
								<label class="radio-inline"> <input type="radio"
									name="upgraderVersionOriginal" value="0" checked="checked">
									是
								</label> 
								<label class="radio-inline"> <input type="radio"
									name="upgraderVersionOriginal" value="1" class="is_VersionOriginal"> 否
								</label>
							</div>
							<div class="col-sm-4 fill_url">
								<input type="url" class="form-control" name="upgraderVersionOriginalRefer" placeholder="参考网址 http://" data-bv-uri-message="地址无效"  required data-bv-notempty-message="仿站地址不能为空"/>
							</div>
						</div>
						<div class="form-group">
							<label for="upgraderVersionPrice" class="col-sm-2 control-label">赞助费</label>
							<div class="col-sm-2">
								<label class="radio-inline"> 
									<input type="radio" name="free" value="0" checked="checked"> 免费
								</label> 
								<label class="radio-inline"> 
									<input type="radio" name="free" value="1" class="is_VersionPrice"> 收费
								</label>
							</div>
							<div class="col-sm-3 fill_VersionPrice">
								<input type="text" class="form-control" maxlength="4"
									name="upgraderVersionPrice" placeholder="整数价格" 
									required data-bv-notempty-message="赞助金额不能为空"/>
							</div>
						</div>

						<!--项目信息-->
						<div class="form-group plug">
							<label class="col-sm-2 control-label">项目名称</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" 
									name="projectName" placeholder="输入项目名称" required
									data-bv-notempty-message="项目名称不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">包名</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" 
									name="projectPackage" placeholder="输入包名" required
									data-bv-notempty-message="包名不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">作者</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" maxlength="20"
									name="projectAuthor" placeholder="输入作者" required
									data-bv-notempty-message="作者不能为空">
							</div>
						</div>

						<div class="form-group plug">
							<label class="col-sm-2 control-label">版本</label>
							<div class="col-sm-4">
								<input type="text" class="form-control" maxlength="3"
									name="projectVersion" placeholder="输入版本" required
									data-bv-notempty-message="版本不能为空">
							</div>
						</div>

						<div class="form-group">
							<label for="upgraderVersionDescription"
								class="col-sm-2 control-label">描述</label>
							<div class="col-sm-9">
								<textarea class="form-control" rows="3" maxlength="200"
									name="upgraderVersionDescription" required
									data-bv-notempty-message="模版描述不能空" data-bv-stringlength="true"
									data-bv-stringlength-max="200" data-bv-stringlength-min="15"
									data-bv-stringlength-message="描述最多200个字符，最少15个字符"></textarea>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-2 col-sm-10">
								<button type="button" class="btn btn-primary submit_share_skin" style="width: 80px">提交</button>
							</div>
						</div>
					</form>


				</div>

			</div>
		</div>
	</div>


	{ms:include filename=footer.htm/}
</html>
<script>
	$(function() {
		/*前端验证赞助金额有效值*/
		$('#upgraderVersion').bootstrapValidator({
			feedbackIcons : {
				valid : 'glyphicon glyphicon-ok',
				invalid : 'glyphicon glyphicon-remove',
				validating : 'glyphicon glyphicon-refresh',
			},
	        fields: {
	            upgraderVersionPrice: {
	                validators: {
	                    between: {
	                        min:100,
	                        max:9000,
	                        message: '赞助金额在100-9000元内'
	                    }
	                }
	            }
			}
		});
		if("{upgraderVersionType/}" != null){
			if("{upgraderVersionType/}" == 1){
				$("#upgraderVersion .skin").hide();
				$("#upgraderVersion .plug").show();
				$("#upgraderVersionType").val("1");
				$(".skin-title").removeClass("active");
				$(".plug-title").addClass("active");
			}else{
				$("#upgraderVersion .skin").show();
				$("#upgraderVersion .plug").hide();
				$("#upgraderVersionType").val("2");
				$(".skin-title").addClass("active");
				$(".plug-title").removeClass("active");

			}
		}
		/*切换分享插件模板*/
		$(".releaseIn span").click(function(){
			$(".releaseIn span").removeClass("active");
			$(this).addClass("active");
			if($(this).hasClass("plug-title")){
				$("#upgraderVersion .skin").hide();
				$("#upgraderVersion .plug").show();
				$("#upgraderVersionType").val("1");
			}else{
				$("#upgraderVersion .skin").show();
				$("#upgraderVersion .plug").hide();
				$("#upgraderVersionType").val("2");
			}
		})
		/*选中是否收费和是否原创的效果*/
		$('.radio-inline').click(function() {
			/*选择收费则显示输入框输入金额*/
		    if($('.is_VersionPrice').is(':checked')) {
		    	$(".fill_VersionPrice").fadeIn();
			}else{
				$(".fill_VersionPrice").fadeOut();
				$(".fill_VersionPrice").bootstrapValidator("resetForm",true); 
			}
			/*选择非原创则显示输入框输入仿站地址*/
			if($(".is_VersionOriginal").is(':checked')) {
		    	$(".fill_url").fadeIn();
			}else{
				$(".fill_url").fadeOut();
				$(".fill_url").bootstrapValidator("resetForm",true); 
			}
		});
	})

	ms.load([ "ms", "ms.upgrader","ms.mcode"], function(ms, upgrader,mcode) {
		$(function() {
			/*提交模板分享*/
			$(".submit_share_skin").click(function() {
				var valid = $("#upgraderVersion").data('bootstrapValidator').validate().isValid();
				if (valid) {
                    $(".submit_share_skin").attr("disabled", true).text("提交中...");
					upgrader.people.save($("#upgraderVersion").serialize(), function(json) {
						if(json.result != null){
							ms.alert("分享申请提交失败，请稍后重新提交");
							$(".submit_share_skin").attr("disabled", false).text("提交");
							return;
						}else{
	                    	$("input[name=projectUpgraderVersionId]").val(json.upgraderVersionId)
							
							/*如果是提交插件分享，那再提交项目信息*/
							if($("input[name=upgraderVersionType]").val() == 1){
								mcode.people.mcode.project.save($("#upgraderVersion").serialize(), function(json) {
									if(json.result != null){
										$(".submit_share_skin").attr("disabled", false).text("提交");
										ms.alert("项目信息保存失败，请稍后重试！");
										return;
									}
								})
							}

							$(".submit_share_skin").attr("disabled", false).text("提交");
							ms.alert("分享申请成功");
							
							location.href=ms.base+"/people/center.do";
						}
					});
				}

			});


		})
	});
>>>>>>> commit
</script>